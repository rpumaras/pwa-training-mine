'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.addItemToWishlist = exports.getProductVariantData = exports.initProductDetailsPage = exports.register = undefined;

var _dataObjects = require('../../analytics/data-objects/');

var _actions = require('../../analytics/actions');

/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */
/* Copyright (c) 2018 Mobify Research & Development Inc. All rights reserved. */
/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */

var connector = {};

var register = exports.register = function register(commands) {
    connector = commands;
};

/**
 * Initializes any required data for the Product Details page
 * @function
 * @param {string} url The url of the current page
 * @param {string} routeName The route name of the current page
 */
var initProductDetailsPage = exports.initProductDetailsPage = function initProductDetailsPage(url, routeName) {
    return function (dispatch) {
        return dispatch(connector.initProductDetailsPage(url, routeName)).then(function () {
            dispatch((0, _actions.sendProductDetailAnalytics)(routeName));
        });
    };
};

/**
 * Called when the user selects a product variation. This provides a
 * hook so that the connector can take some action if needed.
 * @function
 * @param {object} variationSelections The user's product variation selections
 * @param {object} variants The list of product variants
 * @param {object} categoryIds The list of product variation category IDs
 */
var getProductVariantData = exports.getProductVariantData = function getProductVariantData(variationSelections, variants, categoryIds) {
    return connector.getProductVariantData(variationSelections, variants, categoryIds);
};

/**
 * Add a product to the wishlist
 * @function
 * @param productId {string} The product's ID
 * @param productURL {string} The URL of the product's detail page
 * @param quantity {string} The quantity of items being added to the wishlist
 */
var addItemToWishlist = exports.addItemToWishlist = function addItemToWishlist(productId, productURL, quantity) {
    return function (dispatch, getState) {
        return dispatch(connector.addItemToWishlist(productId, productURL, quantity)).then(function () {
            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
                args[_key] = arguments[_key];
            }

            (0, _actions.dispatchWishlistAnalytics)(_dataObjects.EVENT_ACTION.addToWishlist, dispatch, getState, productId, quantity);
            return args;
        });
    };
};