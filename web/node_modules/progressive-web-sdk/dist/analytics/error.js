'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _defineProperty2 = require('babel-runtime/helpers/defineProperty');

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _stringify = require('babel-runtime/core-js/json/stringify');

var _stringify2 = _interopRequireDefault(_stringify);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _dataObjects = require('./data-objects/');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Custom "subclassed" Error type based on: https://stackoverflow.com/a/32749533/11807
var AppError = function (_Error) {
    (0, _inherits3.default)(AppError, _Error);

    function AppError(message) {
        var _window$Progressive$a;

        var errors = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
        (0, _classCallCheck3.default)(this, AppError);

        var _this = (0, _possibleConstructorReturn3.default)(this, (AppError.__proto__ || (0, _getPrototypeOf2.default)(AppError)).call(this, message));

        _this.errors = errors;

        _this.name = _this.constructor.name;
        // Trying to delete Error.captureStackTrace to test the other case breaks in Jest
        /* istanbul ignore else */
        if (typeof Error.captureStackTrace === 'function') {
            Error.captureStackTrace(_this, _this.constructor);
        } else {
            _this.stack = new Error(message).stack;
        }

        var errorContent = (0, _stringify2.default)(errors);

        window.Progressive.analytics.send((_window$Progressive$a = {}, (0, _defineProperty3.default)(_window$Progressive$a, _dataObjects.UIInteraction.SUBJECT, _dataObjects.UI_SUBJECT.app), (0, _defineProperty3.default)(_window$Progressive$a, _dataObjects.UIInteraction.ACTION, _dataObjects.UI_ACTION.receive), (0, _defineProperty3.default)(_window$Progressive$a, _dataObjects.UIInteraction.OBJECT, _dataObjects.UI_OBJECT.error), (0, _defineProperty3.default)(_window$Progressive$a, _dataObjects.UIInteraction.NAME, message), (0, _defineProperty3.default)(_window$Progressive$a, _dataObjects.UIInteraction.CONTENT, errorContent.substr(0, 128)), _window$Progressive$a));
        return _this;
    }

    return AppError;
}(Error); /* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */
/* Copyright (c) 2018 Mobify Research & Development Inc. All rights reserved. */
/* * *  *  * *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * */

exports.default = AppError;